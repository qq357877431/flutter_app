import{_ as J,r as n,a as E,p as K,c as O,d as l,w as a,f as r,q as U,v as Q,o as N,b as d,k as j,x as W,t as c,y as X,j as Y,i as u,z as Z,E as z}from"./index-BMYD5cB_.js";const ee={class:"dashboard"},le={class:"stat-content"},ae={class:"stat-icon users"},se={class:"stat-info"},te={class:"stat-value"},oe={class:"card-header"},re={class:"avatar-emoji"},ne={class:"reset-tip"},de={__name:"DashboardView",setup(ue){const x=n([]),C=n(0),g=n(!1),m=n(!1),b=n(null),y=n(!1),t=E({username:"",phone_number:"",password:""}),A={username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",trigger:"blur"},{min:3,message:"ç”¨æˆ·åè‡³å°‘3ä½",trigger:"blur"}],phone_number:[{required:!0,message:"è¯·è¾“å…¥æ‰‹æœºå·",trigger:"blur"},{pattern:/^1\d{10}$/,message:"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·",trigger:"blur"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"},{min:6,message:"å¯†ç è‡³å°‘6ä½",trigger:"blur"}]},f=n(!1),V=n(null),k=n(!1),h=n(null),_=E({new_password:""}),I={new_password:[{required:!0,message:"è¯·è¾“å…¥æ–°å¯†ç ",trigger:"blur"},{min:6,message:"å¯†ç è‡³å°‘6ä½",trigger:"blur"}]};async function D(){g.value=!0;try{const o=await U.getUsers();x.value=o.users,C.value=o.total}catch(o){console.error(o)}finally{g.value=!1}}async function L(){b.value&&await b.value.validate(async o=>{if(o){y.value=!0;try{await U.createUser(t),z.success("ç”¨æˆ·åˆ›å»ºæˆåŠŸ"),m.value=!1,t.username="",t.phone_number="",t.password="",D()}catch{}finally{y.value=!1}}})}function M(o){h.value=o,_.new_password="",f.value=!0}async function P(){V.value&&await V.value.validate(async o=>{if(o){k.value=!0;try{await U.resetPassword(h.value.id,_.new_password),z.success("å¯†ç é‡ç½®æˆåŠŸ"),f.value=!1}catch{}finally{k.value=!1}}})}return K(()=>{D()}),(o,e)=>{const R=r("el-icon"),F=r("el-card"),S=r("el-col"),T=r("el-row"),p=r("el-button"),i=r("el-table-column"),G=r("el-table"),v=r("el-input"),w=r("el-form-item"),q=r("el-form"),$=r("el-dialog"),H=Q("loading");return N(),O("div",ee,[l(T,{gutter:20,class:"stats-row"},{default:a(()=>[l(S,{span:6},{default:a(()=>[l(F,{class:"stat-card",shadow:"hover"},{default:a(()=>[d("div",le,[d("div",ae,[l(R,{size:28},{default:a(()=>[l(j(W))]),_:1})]),d("div",se,[d("div",te,c(C.value),1),e[9]||(e[9]=d("div",{class:"stat-label"},"æ€»ç”¨æˆ·æ•°",-1))])])]),_:1})]),_:1})]),_:1}),l(F,{class:"user-card",shadow:"never"},{header:a(()=>[d("div",oe,[e[11]||(e[11]=d("span",{class:"title"},"ç”¨æˆ·ç®¡ç†",-1)),l(p,{type:"primary",onClick:e[0]||(e[0]=s=>m.value=!0)},{default:a(()=>[l(R,null,{default:a(()=>[l(j(Z))]),_:1}),e[10]||(e[10]=u(" æ·»åŠ ç”¨æˆ· ",-1))]),_:1})])]),default:a(()=>[X((N(),Y(G,{data:x.value,stripe:""},{default:a(()=>[l(i,{prop:"id",label:"ID",width:"80"}),l(i,{prop:"username",label:"ç”¨æˆ·å",width:"150"}),l(i,{prop:"phone_number",label:"æ‰‹æœºå·",width:"150"}),l(i,{prop:"nickname",label:"æ˜µç§°",width:"120"},{default:a(({row:s})=>[u(c(s.nickname||"-"),1)]),_:1}),l(i,{prop:"avatar",label:"å¤´åƒ",width:"80"},{default:a(({row:s})=>[d("span",re,c(s.avatar||"ğŸ‘¤"),1)]),_:1}),l(i,{prop:"created_at",label:"æ³¨å†Œæ—¶é—´",width:"180"}),l(i,{label:"æ“ä½œ",fixed:"right",width:"120"},{default:a(({row:s})=>[l(p,{type:"primary",link:"",onClick:B=>M(s)},{default:a(()=>[...e[12]||(e[12]=[u(" é‡ç½®å¯†ç  ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,g.value]])]),_:1}),l($,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=s=>m.value=s),title:"æ·»åŠ ç”¨æˆ·",width:"450px"},{footer:a(()=>[l(p,{onClick:e[4]||(e[4]=s=>m.value=!1)},{default:a(()=>[...e[13]||(e[13]=[u("å–æ¶ˆ",-1)])]),_:1}),l(p,{type:"primary",loading:y.value,onClick:L},{default:a(()=>[...e[14]||(e[14]=[u("ç¡®å®š",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(q,{ref_key:"addFormRef",ref:b,model:t,rules:A,"label-width":"80px"},{default:a(()=>[l(w,{label:"ç”¨æˆ·å",prop:"username"},{default:a(()=>[l(v,{modelValue:t.username,"onUpdate:modelValue":e[1]||(e[1]=s=>t.username=s),placeholder:"è¯·è¾“å…¥ç”¨æˆ·åï¼ˆè‡³å°‘3ä½ï¼‰"},null,8,["modelValue"])]),_:1}),l(w,{label:"æ‰‹æœºå·",prop:"phone_number"},{default:a(()=>[l(v,{modelValue:t.phone_number,"onUpdate:modelValue":e[2]||(e[2]=s=>t.phone_number=s),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·"},null,8,["modelValue"])]),_:1}),l(w,{label:"å¯†ç ",prop:"password"},{default:a(()=>[l(v,{modelValue:t.password,"onUpdate:modelValue":e[3]||(e[3]=s=>t.password=s),type:"password",placeholder:"è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l($,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=s=>f.value=s),title:"é‡ç½®å¯†ç ",width:"400px"},{footer:a(()=>[l(p,{onClick:e[7]||(e[7]=s=>f.value=!1)},{default:a(()=>[...e[17]||(e[17]=[u("å–æ¶ˆ",-1)])]),_:1}),l(p,{type:"primary",loading:k.value,onClick:P},{default:a(()=>[...e[18]||(e[18]=[u("ç¡®å®š",-1)])]),_:1},8,["loading"])]),default:a(()=>{var s;return[d("p",ne,[e[15]||(e[15]=u("æ­£åœ¨ä¸ºç”¨æˆ· ",-1)),d("strong",null,c((s=h.value)==null?void 0:s.username),1),e[16]||(e[16]=u(" é‡ç½®å¯†ç ",-1))]),l(q,{ref_key:"resetFormRef",ref:V,model:_,rules:I},{default:a(()=>[l(w,{prop:"new_password"},{default:a(()=>[l(v,{modelValue:_.new_password,"onUpdate:modelValue":e[6]||(e[6]=B=>_.new_password=B),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]}),_:1},8,["modelValue"])])}}},pe=J(de,[["__scopeId","data-v-23b9141d"]]);export{pe as default};
